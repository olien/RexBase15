"id";"typ";"active";"name";"description";"lang";"marker";"html";"allcats";"subcats";"once";"categories";"insertbefore";"excludeids";"useragent";"dataarea";"validfrom";"validto"
"1";"4";"1";"Beispiel_001";"Umpersand durch benanntes Zeichen ersetzen (& -> &amp\~d~)";"0";"/&(?!(?i:\#((x([\dA-F]){1,5})\~r~\~n~|(104857[0-5]\~r~\~n~|10485[0-6]\d\~r~\~n~|1048[0-4]\d\d\~r~\~n~|104[0-7]\d{3}\~r~\~n~|10[0-3]\d{4}\~r~\~n~|0?\d{1,6}))\~r~\~n~|([A-Za-z\d.]{2,31}))\~d~)/x";"&amp\~d~";"1";"1";"0";"";"3";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"2";"4";"0";"Beispiel_002";"HTML-Kommentare entfernen";"0";"/<!--(.|\s)*?-->/\~r~\~n~";"";"1";"1";"0";"";"3";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"3";"4";"0";"Beispiel_003";"Alle HTML-Kommentare entfernen - ausser Conditional Comments für IE";"0";"/<!--[^\[](.|\s)*?[^\]]-->/";"";"1";"1";"0";"";"3";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"4";"4";"0";"Beispiel_004";"JavaScript entfernen";"0";"/<script(.|\s)*?<\/script>/";"";"1";"1";"0";"";"3";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"5";"4";"1";"Beispiel_005";"Ungeschlossene Tags schliessen (<br>, <hr>, <img>, <input>, <meta>, <base>, <basefont>, <param>, <link>, <area>)";"0";"/\~r~\~n~<(br|hr|img|input|meta|base|basefont|param|link|area)\~r~\~n~+\~r~\~n~((\s+[a-zA-Z-]+\s*=\s*(\~q~([^\~q~]*)\~q~|'([^']*)'|([a-zA-Z0-9]*)))*\s*)>\~r~\~n~/ix";"<$1$2 />";"1";"1";"0";"";"3";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"6";"4";"1";"Beispiel_006";"Leere HTML-Tags entfernen (<p>, <span>, <strong>, <b>, <em>, <h1>, <h2>, <h3>, <h4>, <h5>, <h6>)";"0";"/<(p|span|strong|b|em|h1|h2|h3|h4|h5|h6)>(\s|\b)*<\/\1>/";"";"1";"1";"0";"";"3";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"7";"4";"1";"Beispiel_007";"Fehlende alt-Attribute bei <img>-Tags einfügen";"0";"/(?!<img[^>]*\salt[^=>]*=[^>]*>)<img[^>](.*)(>)/";"<img alt=\~q~\~q~ $1>";"1";"1";"0";"";"3";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"8";"4";"1";"Beispiel_008";"Zeichen und Tags ersetzen / entfernen";"0";"<head>";"<?php\~r~\~n~/**\~r~\~n~ * Zeichen und Tags ersetzen / entfernen\~r~\~n~ */\~r~\~n~global $REX\~d~\~r~\~n~\~r~\~n~  $xoutputfilter_codereplace = array(\~r~\~n~  '<b>' => '<strong>' ,\~r~\~n~  '</b>' => '</strong>' ,\~r~\~n~  '<i>' => '<em>' ,\~r~\~n~  '</i>' => '</em>' ,\~r~\~n~  'ä' => '&auml\~d~' ,\~r~\~n~  'ö' => '&ouml\~d~' ,\~r~\~n~  'ü' => '&uuml\~d~' ,\~r~\~n~  'Ä' => '&Auml\~d~' ,\~r~\~n~  'Ö' => '&Ouml\~d~' ,\~r~\~n~  'Ü' => '&Uuml\~d~' ,\~r~\~n~  'ß' => '&szlig\~d~',\~r~\~n~  '(c)' => '&copy\~d~',\~r~\~n~  ' ismap=\~q~ismap\~q~' => '',\~r~\~n~  ' ismap=\~q~true\~q~' => '',\~r~\~n~  ' target=\~q~_self\~q~' => '',\~r~\~n~  ' target=\~q~_blank\~q~' => ' onclick=\~q~window.open(this.href)\~d~ return false\~d~\~q~',\~r~\~n~  '<div align=\~q~center\~q~>' => '<div style=\~q~text-align:center\~d~\~q~>',\~r~\~n~  '<hr width=\~q~100%\~q~ size=\~q~2\~q~ />' => '<hr />'\~r~\~n~  )\~d~\~r~\~n~\~r~\~n~  $search = array()\~d~\~r~\~n~  $replace = array()\~d~\~r~\~n~  foreach ($xoutputfilter_codereplace as $key => $value)\~r~\~n~  {\~r~\~n~    $search[] = $key\~d~\~r~\~n~    $replace[] = $value\~d~\~r~\~n~  }\~r~\~n~  $REX['xoutputfilter']['content'] = str_replace($search, $replace, $REX['xoutputfilter']['content'])\~d~\~r~\~n~?>";"1";"1";"1";"";"4";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"9";"4";"1";"Beispiel_009";"HTML-Attribute in Anführungszeichen, HTML-Tags in Kleinbuchstaben";"0";"<head>";"<?php\~r~\~n~/**\~r~\~n~ * HTML-Attribute in Anführungszeichen, HTML-Tags in Kleinbuchstaben\~r~\~n~ */\~r~\~n~global $REX\~d~\~r~\~n~\~r~\~n~  // HTML-Tags in Kleinbuchstaben\~r~\~n~  $REX['xoutputfilter']['content'] = preg_replace(\~q~#<(/?)([A-Z]+)([^>]+)?(/?)>#ies\~q~, '\~q~<$1\~q~.strtolower(\~q~$2\~q~).\~q~$3$4>\~q~', $REX['xoutputfilter']['content'])\~d~\~r~\~n~\~r~\~n~  // HTML-Attribute in Anführungszeichen\~r~\~n~  $mtchs = array()\~d~\~r~\~n~  $attrs = array()\~d~\~r~\~n~\~r~\~n~  preg_match_all('/(<(link|a|body|div|span|p|br|hr|img|table|tr|td|ul|li|dl|dt)[^<>]+>)/is', $REX['xoutputfilter']['content'], $mtchs)\~d~\~r~\~n~\~r~\~n~  foreach ($mtchs[0] as $mtch)\~r~\~n~  {\~r~\~n~    preg_match_all('/([\w]+)=(.*?)(?:\s|>)/is', $mtch, $attrs)\~d~\~r~\~n~    $c = count ($attrs[0])\~d~\~r~\~n~    if ($c <> 0)\~r~\~n~    {\~r~\~n~      for ($i = 0\~d~ $i < $c\~d~ $i++)\~r~\~n~      {\~r~\~n~        if (($attrs[2][$i]{0} != '\~q~') )//and ($attrs[2][$i]{0} != '\'')\~r~\~n~        {\~r~\~n~          $srch[] = $attrs[1][$i].'='.$attrs[2][$i]\~d~\~r~\~n~          $rplc[] = strtolower($attrs[1][$i]).'=\~q~'.str_replace('\\\'','',$attrs[2][$i]).'\~q~'\~d~\~r~\~n~        }\~r~\~n~      }\~r~\~n~    }\~r~\~n~  }\~r~\~n~\~r~\~n~  if (isset($srch) and is_array($srch))\~r~\~n~  {\~r~\~n~    $REX['xoutputfilter']['content'] = str_replace($srch, $rplc, $REX['xoutputfilter']['content'])\~d~\~r~\~n~  }\~r~\~n~?>";"1";"1";"1";"";"4";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"10";"4";"1";"Beispiel_010";"E-Mail-Adressen mit Klasse email versehen und verschlüsseln";"0";"mailto:";"<?php\~r~\~n~/**\~r~\~n~ * E-Mail Adressen verschlüsseln\~r~\~n~ */\~r~\~n~global $REX\~d~\~r~\~n~\~r~\~n~  // hier via regEx alle absoluten, externen Linkadressen heraussuchen\~r~\~n~  preg_match_all(\~q~/<a[^>]*(href\s*=\s*(\\~q~|')(mailto)(?=:).*?(\\~q~|'))[^>]*>(.*?)<\/a>/ims\~q~, $REX['xoutputfilter']['content'], $matches)\~d~\~r~\~n~\~r~\~n~  // hier jetzt alle gefundenen durchgehen und um klasse erweitern\~r~\~n~  if ( isset ($matches[0][0]) and $matches[0][0] != '')\~r~\~n~  {\~r~\~n~    for ($m = 0\~d~ $m < count ($matches[0])\~d~ $m++)\~r~\~n~    {\~r~\~n~      $msearch = $matches[0][$m]\~d~\~r~\~n~      if (strstr($matches[0][$m], 'class='))\~r~\~n~      {\~r~\~n~        $mreplace = $matches[0][$m]\~d~\~r~\~n~      }\~r~\~n~      else\~r~\~n~      {\~r~\~n~        $mreplace = str_replace('href=', 'class=\~q~email\~q~ href=', $matches[0][$m])\~d~\~r~\~n~      }\~r~\~n~      $REX['xoutputfilter']['content'] = str_replace($msearch, $mreplace, $REX['xoutputfilter']['content'])\~d~\~r~\~n~    }\~r~\~n~  }\~r~\~n~\~r~\~n~  // hier jetzt alle gefundenen durchgehen und crypt\~r~\~n~  if ( isset ($matches[1][0]) and $matches[1][0] != '')\~r~\~n~  {\~r~\~n~    for ($m = 0\~d~ $m < count ($matches[1])\~d~ $m++)\~r~\~n~    {\~r~\~n~      $va = explode('mailto:', $matches[1][$m])\~d~\~r~\~n~      $originalemail = str_replace('\~q~', '', $va[1])\~d~\~r~\~n~\~r~\~n~      $encryptedemail = ''\~d~\~r~\~n~      for ($i=0\~d~ $i < strlen($originalemail)\~d~ $i++) {\~r~\~n~        $encryptedemail .= '&#'.ord(substr($originalemail, $i, 1)).'\~d~'\~d~\~r~\~n~      }\~r~\~n~\~r~\~n~      $msearch = 'mailto:'.$originalemail\~d~\~r~\~n~      $mreplace = 'mailto:'.str_replace('&#64\~d~', '%40', $encryptedemail)\~d~\~r~\~n~      $REX['xoutputfilter']['content'] = str_replace($msearch, $mreplace, $REX['xoutputfilter']['content'])\~d~\~r~\~n~\~r~\~n~      $msearch = $originalemail\~d~\~r~\~n~      $mreplace = $encryptedemail\~d~\~r~\~n~      $REX['xoutputfilter']['content'] = str_replace($msearch, $mreplace, $REX['xoutputfilter']['content'])\~d~\~r~\~n~    }\~r~\~n~  }\~r~\~n~?>";"1";"1";"1";"";"4";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"13";"4";"0";"Beispiel_011";"Unverlinkte Domains verlinken";"0";"<head>";"<?php\~r~\~n~/**\~r~\~n~ * Unverlinkte Domains verlinken\~r~\~n~ */\~r~\~n~global $REX\~d~\~r~\~n~\~r~\~n~  $regex = array()\~d~\~r~\~n~  $regex[] = \~q~{ \\b(?<![\\~q~>])((https?|ftp):[\\w/\\#~:.?+=&%@!\\-]+?)(?=[.:?\\-]*(?:[^\\w/\\#~:.?+=&%@!\\-]|$)) }x\~q~\~d~\~r~\~n~  $regex[] = \~q~{ (?<![\\~q~>])(>|\\s)+\\b((www)[\\w/\\#~:.?+=&%@!\\-]+?)(?=[.:?\\-]*(?:[^\\w/\\#~:.?+=&%@!\\-]|$)) }x\~q~\~d~\~r~\~n~\~r~\~n~  $replace = array()\~d~\~r~\~n~  $replace[] = \~q~<a href=\\~q~$1\\~q~>$1</a>\~q~\~d~\~r~\~n~  $replace[] = \~q~$1<a href=\\~q~http://$2\\~q~>$2</a>\~q~\~d~\~r~\~n~\~r~\~n~  $REX['xoutputfilter']['content'] = preg_replace($regex, $replace, $REX['xoutputfilter']['content'])\~d~\~r~\~n~?>";"1";"1";"1";"";"4";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"11";"4";"1";"Beispiel_012";"Externe Links mit Klasse extern versehen";"0";"href=\~q~http:";"<?php\~r~\~n~/**\~r~\~n~ * Kennzeichnung externe Links mit Ausnahme\~r~\~n~ */\~r~\~n~global $REX\~d~\~r~\~n~\~r~\~n~  //$content = $REX['xoutputfilter']['content']\~d~\~r~\~n~\~r~\~n~  // Von der Ersetzung ausgeschlossen:\~r~\~n~  $excl = array()\~d~\~r~\~n~  $excl[] = 'href=\~q~' . $REX['SERVER']\~d~\~r~\~n~  $excl[] = 'href=\~q~http://' . $_SERVER['HTTP_HOST']\~d~\~r~\~n~  $excl[] = 'href=\~q~https://' . $_SERVER['HTTP_HOST']\~d~\~r~\~n~  $excl[] = '#top'\~d~\~r~\~n~  $excl[] = '#nav'\~d~\~r~\~n~  $excl[] = '#mainnav'\~d~\~r~\~n~  $excl[] = '#hauptnavigation'\~d~\~r~\~n~  $excl[] = '#content'\~d~\~r~\~n~  $excl[] = 'href=\~q~http://www.facebook.com/'\~d~\~r~\~n~  $excl[] = 'href=\~q~http://twitter.com/'\~d~\~r~\~n~\~r~\~n~  // hier via regEx alle absoluten, externen Linkadressen heraussuchen\~r~\~n~  preg_match_all(\~q~/<a[^>]*(href\s*=\s*(\\~q~|')(http(s)?|ftp(s)?|telnet|irc)(?=:\/\/).*?(\\~q~|'))[^>]*>(.*?)<\/a>/ims\~q~, $REX['xoutputfilter']['content'], $matches)\~d~\~r~\~n~\~r~\~n~  if ( isset ($matches[0][0]) and $matches[0][0] != '')\~r~\~n~  {\~r~\~n~    $srch = $repl = array()\~d~\~r~\~n~    for ($m = 0\~d~ $m < count ($matches[0])\~d~ $m++)\~r~\~n~    {\~r~\~n~      $msearch = $matches[0][$m]\~d~\~r~\~n~      if (strstr($matches[0][$m], 'class='))\~r~\~n~      {\~r~\~n~        $mreplace = $matches[0][$m]\~d~\~r~\~n~      }\~r~\~n~      else\~r~\~n~      {\~r~\~n~        $mreplace = str_replace('href=', 'class=\~q~extern\~q~ href=', $matches[0][$m])\~d~\~r~\~n~      }\~r~\~n~      for ($x = 0\~d~ $x < count($excl)\~d~ $x++)\~r~\~n~      {\~r~\~n~        if (strstr($matches[1][$m], $excl[$x]))\~r~\~n~        {\~r~\~n~          $mreplace = $matches[0][$m]\~d~\~r~\~n~        }\~r~\~n~      }\~r~\~n~      $srch[] = $msearch\~d~\~r~\~n~      $repl[] = $mreplace\~d~\~r~\~n~    }\~r~\~n~    $REX['xoutputfilter']['content'] = str_replace($srch, $repl, $REX['xoutputfilter']['content'])\~d~\~r~\~n~  }  \~r~\~n~?>";"1";"1";"1";"";"4";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"
"12";"4";"0";"Beispiel_013";"Wartungsarbeiten - Nicht angemeldete Benutzer auf eine Wartungsseite umleiten";"0";"<head>";"<?php\~r~\~n~/**\~r~\~n~* Wartungsarbeiten\~r~\~n~*/\~r~\~n~  global $REX\~d~\~r~\~n~\~r~\~n~  // Hier die URL angeben auf die weitergeleitet werden soll!\~r~\~n~  $offline_url = $REX['SERVER'] . 'wartungsarbeiten.html'\~d~\~r~\~n~\~r~\~n~  // evtl. Weiterleitung\~r~\~n~  @session_start()\~d~\~r~\~n~  $islogon = false\~d~\~r~\~n~  \~r~\~n~  if (isset($_SESSION[$REX['INSTNAME']]) and isset($_SESSION[$REX['INSTNAME']]['UID']) and $_SESSION[$REX['INSTNAME']]['UID']<>'')\~r~\~n~  {\~r~\~n~    $islogon = true\~d~\~r~\~n~  }\~r~\~n~\~r~\~n~  if (!$islogon) \~r~\~n~  {\~r~\~n~    if ( !strstr($_SERVER[\~q~REQUEST_URI\~q~], '&maintenance') )\~r~\~n~    {\~r~\~n~      $trash = ob_get_contents()\~d~\~r~\~n~      ob_end_clean()\~d~\~r~\~n~      if (strstr($offline_url, '?'))\~r~\~n~      {\~r~\~n~        header('Location: ' . $offline_url . '&maintenance')\~d~\~r~\~n~      }\~r~\~n~      else\~r~\~n~      {\~r~\~n~        header('Location: ' . $offline_url)\~d~\~r~\~n~      }\~r~\~n~      \~r~\~n~    }\~r~\~n~  }\~r~\~n~?>";"1";"1";"1";"";"4";"";"";"";"0000-00-00 00:00:00";"0000-00-00 00:00:00"